---
title: "Time series analysis in the frequency domain"
subtitle: "FISH 507 â€“ Applied Time Series Analysis"
author: "Mark Scheuerell"
date: "28 Feb 2019"
output:
  ioslides_presentation:
    css: lecture_slides.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(MARSS)
set.seed(123)
```

## Topics for today

What is the frequency domain?

Fourier transforms

Spectral analysis

Wavelets


## Time domain

```{r}
par(mai = c(0.9,0.9,0.3,0.1), omi = c(0,0,0,0))

plot.ts(cumsum(rnorm(50,0,1)),
        ylab = expression(italic(x[t])))
```

We having been examining changes in $x_t$ over time


## Time domain

We can think of this as comparing changes in amplitude (displacement) with time


## Frequency domain

Today we'll consider how amplitude changes with frequency


## Jean-Baptiste Fourier (1768 - 1830)

French mathematician best known for his studies of heat transfer

First described what we now call the "greenhouse effect"


## Solving hard problems

Solving the heat equation involves solving _partial differential equations_, subjected to some boundary conditions

$$
\begin{matrix}
\large \text{Problem} \\
really \downarrow hard \\
\large \text{Solution}
\end{matrix}
$$


## Fourier's approach

Find $f(t)$ and $\hat{f}(t)$, such that

$$
\begin{matrix}
\large \text{Problem} && \xrightarrow{f(t)} && \large \text{Transformed problem} \\
really \downarrow hard && && much \downarrow easier \\
\large \text{Solution}  && \xleftarrow{\hat{f}(t)} && \large \text{Transformed solution} \\
\end{matrix}
$$


## Fourier series

Complex periodic functions can be written as infinite sums of sine and cosine waves

$$
f(t) = \frac{1}{2} a_0 + \sum_{n = 1}^\infty [a_n \cos(n t) + b_n \sin(n t)] 
$$


## Fourier series

[animated example](https://upload.wikimedia.org/wikipedia/commons/7/72/Fourier_transform_time_and_frequency_domains_%28small%29.gif)


## Fourier transform

We can make use of Euler's formula

$$
\cos(2 \pi \theta) + i \sin(2 \pi \theta) = e^{2 \pi i \theta}
$$

and write the Fourier transform of $f(t)$ as

$$
f(t) = \int_{-\infty}^\infty \hat{f}(\theta) ~ e^{2 \pi i t \theta} ~ d \theta
$$

where $\theta$ is the frequency


